{
  "lexicon": 1,
  "id": "pub.chive.eprint.submission",
  "defs": {
    "main": {
      "type": "record",
      "description": "A scholarly eprint submission record",
      "key": "tid",
      "record": {
        "type": "object",
        "required": [
          "title",
          "abstract",
          "document",
          "licenseSlug",
          "authors",
          "submittedBy",
          "createdAt"
        ],
        "properties": {
          "title": {
            "type": "string",
            "description": "Eprint title",
            "maxLength": 500
          },
          "abstract": {
            "type": "array",
            "description": "Rich abstract with text and node references",
            "items": {
              "type": "union",
              "refs": ["#textItem", "#nodeRefItem"]
            },
            "maxLength": 100
          },
          "abstractPlainText": {
            "type": "string",
            "description": "Plain text abstract for search indexing (auto-generated)",
            "maxLength": 10000
          },
          "document": {
            "type": "blob",
            "description": "Primary manuscript document (PDF, DOCX, HTML, Markdown, LaTeX, or Jupyter)",
            "accept": [
              "application/pdf",
              "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
              "text/html",
              "text/markdown",
              "text/x-markdown",
              "text/x-tex",
              "application/x-tex",
              "application/x-ipynb+json",
              "application/vnd.oasis.opendocument.text",
              "application/rtf",
              "application/epub+zip",
              "text/plain"
            ],
            "maxSize": 52428800
          },
          "documentFormatUri": {
            "type": "string",
            "format": "at-uri",
            "description": "AT-URI to document format node (subkind=document-format)"
          },
          "documentFormatSlug": {
            "type": "string",
            "description": "Document format slug for display fallback",
            "knownValues": [
              "pdf",
              "docx",
              "html",
              "markdown",
              "latex",
              "jupyter",
              "odt",
              "rtf",
              "epub",
              "txt"
            ]
          },
          "supplementaryMaterials": {
            "type": "array",
            "description": "Additional materials (appendices, data, code, figures)",
            "items": {
              "type": "ref",
              "ref": "#supplementaryItem"
            },
            "maxLength": 50
          },
          "authors": {
            "type": "array",
            "description": "All authors with contributions, affiliations, and metadata",
            "items": {
              "type": "ref",
              "ref": "pub.chive.eprint.authorContribution"
            },
            "minLength": 1,
            "maxLength": 100
          },
          "submittedBy": {
            "type": "string",
            "format": "did",
            "description": "DID of the human user who submitted this eprint"
          },
          "paperDid": {
            "type": "string",
            "format": "did",
            "description": "DID of the paper's own account (if paper has its own PDS)"
          },
          "keywords": {
            "type": "array",
            "description": "Author-provided keywords",
            "items": {
              "type": "string",
              "maxLength": 100
            },
            "maxLength": 20
          },
          "fieldUris": {
            "type": "array",
            "description": "Field node references (subkind=field)",
            "items": {
              "type": "string",
              "format": "at-uri"
            },
            "maxLength": 10
          },
          "topicUris": {
            "type": "array",
            "description": "Topic node references (subkind=topic)",
            "items": {
              "type": "string",
              "format": "at-uri"
            },
            "maxLength": 20
          },
          "facetUris": {
            "type": "array",
            "description": "Facet node references (subkind=facet)",
            "items": {
              "type": "string",
              "format": "at-uri"
            },
            "maxLength": 30
          },
          "version": {
            "type": "ref",
            "ref": "#semanticVersion",
            "description": "Semantic version of this eprint"
          },
          "versionNumber": {
            "type": "integer",
            "description": "Legacy version number (1-indexed), deprecated in favor of semanticVersion",
            "minimum": 1
          },
          "previousVersion": {
            "type": "string",
            "format": "at-uri",
            "description": "Previous version URI"
          },
          "licenseUri": {
            "type": "string",
            "format": "at-uri",
            "description": "AT-URI to license node (subkind=license)"
          },
          "licenseSlug": {
            "type": "string",
            "description": "SPDX license identifier for display fallback",
            "knownValues": ["CC-BY-4.0", "CC-BY-SA-4.0", "CC0-1.0", "MIT", "Apache-2.0"]
          },
          "publicationStatusUri": {
            "type": "string",
            "format": "at-uri",
            "description": "AT-URI to publication status node (subkind=publication-status)"
          },
          "publicationStatusSlug": {
            "type": "string",
            "description": "Publication status slug for display fallback",
            "knownValues": [
              "preprint",
              "under_review",
              "revision_requested",
              "accepted",
              "in_press",
              "published",
              "retracted"
            ],
            "default": "preprint"
          },
          "paperTypeUri": {
            "type": "string",
            "format": "at-uri",
            "description": "AT-URI to paper type node (subkind=paper-type)"
          },
          "paperTypeSlug": {
            "type": "string",
            "description": "Paper type slug for display fallback",
            "knownValues": [
              "original-research",
              "review",
              "meta-analysis",
              "case-study",
              "commentary",
              "tutorial",
              "survey"
            ]
          },
          "publishedVersion": {
            "type": "ref",
            "ref": "#publishedVersion",
            "description": "Link to the published version (Version of Record)"
          },
          "relatedWorks": {
            "type": "array",
            "description": "Related eprints, datasets, software, and prior versions",
            "items": {
              "type": "ref",
              "ref": "#relatedWork"
            },
            "maxLength": 50
          },
          "externalIds": {
            "type": "ref",
            "ref": "#externalIds",
            "description": "External persistent identifiers"
          },
          "repositories": {
            "type": "ref",
            "ref": "#repositories",
            "description": "Linked code, data, and materials repositories"
          },
          "funding": {
            "type": "array",
            "description": "Funding sources and grants",
            "items": {
              "type": "ref",
              "ref": "#fundingSource"
            },
            "maxLength": 20
          },
          "conferencePresentation": {
            "type": "ref",
            "ref": "#conferencePresentation",
            "description": "Conference where this work was presented"
          },
          "createdAt": {
            "type": "string",
            "format": "datetime",
            "description": "Creation timestamp"
          }
        }
      }
    },
    "supplementaryItem": {
      "type": "object",
      "description": "A supplementary material item with metadata",
      "required": ["blob", "label"],
      "properties": {
        "blob": {
          "type": "blob",
          "description": "Supplementary file blob reference",
          "maxSize": 104857600
        },
        "label": {
          "type": "string",
          "description": "User-provided label (e.g., 'Appendix A', 'Figure S1')",
          "maxLength": 200
        },
        "description": {
          "type": "string",
          "description": "Description of the supplementary material",
          "maxLength": 1000
        },
        "categoryUri": {
          "type": "string",
          "format": "at-uri",
          "description": "AT-URI to supplementary category node (subkind=supplementary-category)"
        },
        "categorySlug": {
          "type": "string",
          "description": "Category slug for display fallback",
          "knownValues": [
            "appendix",
            "figure",
            "table",
            "dataset",
            "code",
            "notebook",
            "video",
            "audio",
            "presentation",
            "protocol",
            "questionnaire",
            "other"
          ]
        },
        "detectedFormat": {
          "type": "string",
          "description": "Auto-detected file format"
        },
        "order": {
          "type": "integer",
          "description": "Display order (1-indexed)",
          "minimum": 1
        }
      }
    },
    "publishedVersion": {
      "type": "object",
      "description": "Link to the published version (Version of Record)",
      "properties": {
        "doi": {
          "type": "string",
          "description": "DOI of the published version (e.g., 10.1234/example)"
        },
        "url": {
          "type": "string",
          "format": "uri",
          "description": "URL to the published version"
        },
        "publishedAt": {
          "type": "string",
          "format": "datetime",
          "description": "Publication date"
        },
        "journal": {
          "type": "string",
          "description": "Journal name",
          "maxLength": 500
        },
        "journalAbbreviation": {
          "type": "string",
          "description": "Journal abbreviation",
          "maxLength": 100
        },
        "journalIssn": {
          "type": "string",
          "description": "Journal ISSN"
        },
        "publisher": {
          "type": "string",
          "description": "Publisher name",
          "maxLength": 300
        },
        "volume": {
          "type": "string",
          "description": "Volume number",
          "maxLength": 50
        },
        "issue": {
          "type": "string",
          "description": "Issue number",
          "maxLength": 50
        },
        "pages": {
          "type": "string",
          "description": "Page range",
          "maxLength": 50
        },
        "articleNumber": {
          "type": "string",
          "description": "Article number",
          "maxLength": 50
        },
        "eLocationId": {
          "type": "string",
          "description": "Electronic location ID for online-only journals"
        },
        "accessType": {
          "type": "string",
          "description": "Open access status",
          "knownValues": ["open_access", "green_oa", "gold_oa", "hybrid_oa", "bronze_oa", "closed"]
        },
        "licenseUrl": {
          "type": "string",
          "format": "uri",
          "description": "License URL"
        }
      }
    },
    "relatedWork": {
      "type": "object",
      "description": "A related work with DataCite-compatible relation type",
      "required": ["identifier", "identifierType", "relationType"],
      "properties": {
        "identifier": {
          "type": "string",
          "description": "Identifier value"
        },
        "identifierType": {
          "type": "string",
          "description": "Type of identifier",
          "knownValues": [
            "doi",
            "arxiv",
            "pmid",
            "pmcid",
            "url",
            "urn",
            "handle",
            "isbn",
            "issn",
            "at-uri"
          ]
        },
        "relationType": {
          "type": "string",
          "description": "DataCite-compatible relation type",
          "knownValues": [
            "isPreprintOf",
            "hasPreprint",
            "isVersionOf",
            "hasVersion",
            "isNewVersionOf",
            "isPreviousVersionOf",
            "isPartOf",
            "hasPart",
            "references",
            "isReferencedBy",
            "isSupplementTo",
            "isSupplementedBy",
            "isContinuedBy",
            "continues",
            "isDocumentedBy",
            "documents",
            "isCompiledBy",
            "compiles",
            "isVariantFormOf",
            "isOriginalFormOf",
            "isIdenticalTo",
            "isReviewedBy",
            "reviews",
            "isDerivedFrom",
            "isSourceOf",
            "isRequiredBy",
            "requires",
            "isObsoletedBy",
            "obsoletes"
          ]
        },
        "title": {
          "type": "string",
          "description": "Title of the related work"
        },
        "description": {
          "type": "string",
          "description": "Description of the relation"
        }
      }
    },
    "externalIds": {
      "type": "object",
      "description": "External persistent identifiers",
      "properties": {
        "arxivId": {
          "type": "string",
          "description": "arXiv identifier"
        },
        "pmid": {
          "type": "string",
          "description": "PubMed ID"
        },
        "pmcid": {
          "type": "string",
          "description": "PubMed Central ID"
        },
        "ssrnId": {
          "type": "string",
          "description": "SSRN identifier"
        },
        "osf": {
          "type": "string",
          "description": "OSF identifier"
        },
        "zenodoDoi": {
          "type": "string",
          "description": "Zenodo DOI"
        },
        "openAlexId": {
          "type": "string",
          "description": "OpenAlex identifier"
        },
        "semanticScholarId": {
          "type": "string",
          "description": "Semantic Scholar identifier"
        },
        "coreSid": {
          "type": "string",
          "description": "CORE identifier"
        },
        "magId": {
          "type": "string",
          "description": "Microsoft Academic Graph ID (legacy)"
        }
      }
    },
    "repositories": {
      "type": "object",
      "description": "Linked code, data, and materials repositories",
      "properties": {
        "code": {
          "type": "array",
          "description": "Code repositories",
          "items": {
            "type": "ref",
            "ref": "#codeRepository"
          },
          "maxLength": 10
        },
        "data": {
          "type": "array",
          "description": "Data repositories",
          "items": {
            "type": "ref",
            "ref": "#dataRepository"
          },
          "maxLength": 20
        },
        "preregistration": {
          "type": "ref",
          "ref": "#preregistration",
          "description": "Pre-registration or registered report link"
        },
        "protocols": {
          "type": "array",
          "description": "Protocol links",
          "items": {
            "type": "ref",
            "ref": "#protocol"
          },
          "maxLength": 10
        },
        "materials": {
          "type": "array",
          "description": "Physical materials, reagents, plasmids, etc.",
          "items": {
            "type": "ref",
            "ref": "#material"
          },
          "maxLength": 20
        }
      }
    },
    "codeRepository": {
      "type": "object",
      "description": "A code repository link",
      "properties": {
        "url": {
          "type": "string",
          "format": "uri",
          "description": "Repository URL"
        },
        "platformUri": {
          "type": "string",
          "format": "at-uri",
          "description": "AT-URI to platform node (subkind=platform-code)"
        },
        "platformSlug": {
          "type": "string",
          "description": "Platform slug for display fallback",
          "knownValues": [
            "github",
            "gitlab",
            "bitbucket",
            "huggingface",
            "paperswithcode",
            "codeberg",
            "sourcehut",
            "software_heritage",
            "colab",
            "kaggle",
            "other"
          ]
        },
        "label": {
          "type": "string",
          "description": "User-provided label"
        },
        "archiveUrl": {
          "type": "string",
          "format": "uri",
          "description": "Software Heritage archive URL"
        },
        "swhid": {
          "type": "string",
          "description": "Software Heritage Identifier"
        }
      }
    },
    "dataRepository": {
      "type": "object",
      "description": "A data repository link",
      "properties": {
        "url": {
          "type": "string",
          "format": "uri",
          "description": "Repository URL"
        },
        "doi": {
          "type": "string",
          "description": "Dataset DOI"
        },
        "platformUri": {
          "type": "string",
          "format": "at-uri",
          "description": "AT-URI to platform node (subkind=platform-data)"
        },
        "platformSlug": {
          "type": "string",
          "description": "Platform slug for display fallback",
          "knownValues": [
            "huggingface",
            "zenodo",
            "figshare",
            "dryad",
            "osf",
            "dataverse",
            "mendeley_data",
            "kaggle",
            "wandb",
            "other"
          ]
        },
        "label": {
          "type": "string",
          "description": "User-provided label"
        },
        "accessStatement": {
          "type": "string",
          "description": "Data availability statement"
        }
      }
    },
    "preregistration": {
      "type": "object",
      "description": "Pre-registration or registered report link",
      "properties": {
        "url": {
          "type": "string",
          "format": "uri",
          "description": "Pre-registration URL"
        },
        "platformUri": {
          "type": "string",
          "format": "at-uri",
          "description": "AT-URI to platform node (subkind=platform-preregistration)"
        },
        "platformSlug": {
          "type": "string",
          "description": "Platform slug for display fallback",
          "knownValues": ["osf", "aspredicted", "clinicaltrials", "prospero", "other"]
        },
        "registrationDate": {
          "type": "string",
          "format": "datetime",
          "description": "Registration date"
        }
      }
    },
    "protocol": {
      "type": "object",
      "description": "A protocol link",
      "properties": {
        "url": {
          "type": "string",
          "format": "uri",
          "description": "Protocol URL"
        },
        "doi": {
          "type": "string",
          "description": "Protocol DOI"
        },
        "platformUri": {
          "type": "string",
          "format": "at-uri",
          "description": "AT-URI to platform node (subkind=platform-protocol)"
        },
        "platformSlug": {
          "type": "string",
          "description": "Platform slug for display fallback",
          "knownValues": ["protocols_io", "bio_protocol", "other"]
        }
      }
    },
    "material": {
      "type": "object",
      "description": "A physical material, reagent, or plasmid",
      "properties": {
        "url": {
          "type": "string",
          "format": "uri",
          "description": "Material URL"
        },
        "rrid": {
          "type": "string",
          "description": "Research Resource Identifier"
        },
        "label": {
          "type": "string",
          "description": "User-provided label"
        }
      }
    },
    "fundingSource": {
      "type": "object",
      "description": "A funding source",
      "properties": {
        "funderName": {
          "type": "string",
          "description": "Funder name",
          "maxLength": 300
        },
        "funderUri": {
          "type": "string",
          "format": "at-uri",
          "description": "AT-URI to funder institution node (subkind=institution)"
        },
        "funderDoi": {
          "type": "string",
          "description": "CrossRef Funder Registry DOI"
        },
        "funderRor": {
          "type": "string",
          "description": "ROR identifier"
        },
        "grantNumber": {
          "type": "string",
          "description": "Grant number",
          "maxLength": 100
        },
        "grantTitle": {
          "type": "string",
          "description": "Grant title",
          "maxLength": 500
        },
        "grantUrl": {
          "type": "string",
          "format": "uri",
          "description": "Grant URL"
        }
      }
    },
    "conferencePresentation": {
      "type": "object",
      "description": "Conference where this work was presented",
      "properties": {
        "conferenceName": {
          "type": "string",
          "description": "Conference name",
          "maxLength": 500
        },
        "conferenceAcronym": {
          "type": "string",
          "description": "Conference acronym",
          "maxLength": 50
        },
        "conferenceUri": {
          "type": "string",
          "format": "at-uri",
          "description": "AT-URI to conference/event node (subkind=event)"
        },
        "conferenceUrl": {
          "type": "string",
          "format": "uri",
          "description": "Conference website URL"
        },
        "conferenceLocation": {
          "type": "string",
          "description": "Conference location"
        },
        "presentationDate": {
          "type": "string",
          "format": "datetime",
          "description": "Presentation date"
        },
        "presentationTypeUri": {
          "type": "string",
          "format": "at-uri",
          "description": "AT-URI to presentation type node (subkind=presentation-type)"
        },
        "presentationTypeSlug": {
          "type": "string",
          "description": "Presentation type slug for display fallback",
          "knownValues": ["oral", "poster", "keynote", "workshop", "demo", "other"]
        },
        "proceedingsDoi": {
          "type": "string",
          "description": "Proceedings DOI"
        }
      }
    },
    "textItem": {
      "type": "object",
      "description": "Plain text content item in rich abstract, with optional formatting facets",
      "required": ["type", "content"],
      "properties": {
        "type": {
          "type": "string",
          "const": "text"
        },
        "content": {
          "type": "string",
          "maxLength": 10000
        },
        "facets": {
          "type": "array",
          "description": "ATProto-style facets for rich text formatting",
          "items": {
            "type": "ref",
            "ref": "#facet"
          },
          "maxLength": 500
        }
      }
    },
    "facet": {
      "type": "object",
      "description": "ATProto-compatible facet for rich text formatting",
      "required": ["index", "features"],
      "properties": {
        "index": {
          "type": "ref",
          "ref": "#byteSlice"
        },
        "features": {
          "type": "array",
          "items": {
            "type": "union",
            "refs": [
              "#boldFacet",
              "#italicFacet",
              "#strikethroughFacet",
              "#codeFacet",
              "#latexFacet",
              "#linkFacet"
            ]
          }
        }
      }
    },
    "byteSlice": {
      "type": "object",
      "description": "Byte range for facet positioning",
      "required": ["byteStart", "byteEnd"],
      "properties": {
        "byteStart": {
          "type": "integer",
          "description": "Start byte position (inclusive)",
          "minimum": 0
        },
        "byteEnd": {
          "type": "integer",
          "description": "End byte position (exclusive)",
          "minimum": 0
        }
      }
    },
    "boldFacet": {
      "type": "object",
      "description": "Bold text formatting",
      "required": ["$type"],
      "properties": {
        "$type": {
          "type": "string",
          "const": "pub.chive.richtext.facets#bold"
        }
      }
    },
    "italicFacet": {
      "type": "object",
      "description": "Italic text formatting",
      "required": ["$type"],
      "properties": {
        "$type": {
          "type": "string",
          "const": "pub.chive.richtext.facets#italic"
        }
      }
    },
    "strikethroughFacet": {
      "type": "object",
      "description": "Strikethrough text formatting",
      "required": ["$type"],
      "properties": {
        "$type": {
          "type": "string",
          "const": "pub.chive.richtext.facets#strikethrough"
        }
      }
    },
    "codeFacet": {
      "type": "object",
      "description": "Inline code formatting",
      "required": ["$type"],
      "properties": {
        "$type": {
          "type": "string",
          "const": "pub.chive.richtext.facets#code"
        }
      }
    },
    "latexFacet": {
      "type": "object",
      "description": "LaTeX math expression",
      "required": ["$type", "displayMode"],
      "properties": {
        "$type": {
          "type": "string",
          "const": "pub.chive.richtext.facets#latex"
        },
        "displayMode": {
          "type": "boolean",
          "description": "True for block display ($$...$$), false for inline ($...$)"
        }
      }
    },
    "linkFacet": {
      "type": "object",
      "description": "Hyperlink",
      "required": ["$type", "uri"],
      "properties": {
        "$type": {
          "type": "string",
          "const": "app.bsky.richtext.facet#link"
        },
        "uri": {
          "type": "string",
          "format": "uri",
          "description": "Link target URL"
        }
      }
    },
    "nodeRefItem": {
      "type": "object",
      "description": "Reference to a knowledge graph node in rich abstract",
      "required": ["type", "uri"],
      "properties": {
        "type": {
          "type": "string",
          "const": "nodeRef"
        },
        "uri": {
          "type": "string",
          "format": "at-uri",
          "description": "AT-URI of the referenced node"
        },
        "label": {
          "type": "string",
          "maxLength": 500,
          "description": "Display label (cached from node)"
        },
        "subkind": {
          "type": "string",
          "maxLength": 50,
          "description": "Subkind slug for styling"
        }
      }
    },
    "semanticVersion": {
      "type": "object",
      "description": "Semantic version following MAJOR.MINOR.PATCH",
      "required": ["major", "minor", "patch"],
      "properties": {
        "major": {
          "type": "integer",
          "description": "Major version for fundamental revisions or breaking changes",
          "minimum": 1
        },
        "minor": {
          "type": "integer",
          "description": "Minor version for new content or significant additions",
          "minimum": 0
        },
        "patch": {
          "type": "integer",
          "description": "Patch version for corrections, typo fixes, formatting",
          "minimum": 0
        },
        "prerelease": {
          "type": "string",
          "description": "Pre-release identifier (e.g., draft, rc1)",
          "maxLength": 20
        }
      }
    }
  }
}
