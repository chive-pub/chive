# Casbin RBAC policies for Chive
#
# Format: p, role, resource_type, action
# p = permission policy
# g = user-role assignment
# g2 = role hierarchy

# Role hierarchy (higher role includes lower role permissions)
g2, admin, moderator
g2, moderator, graph-editor
g2, graph-editor, author
g2, author, reader

# Admin permissions (full access)
p, admin, *, *

# Moderator permissions
p, moderator, eprint, read
p, moderator, eprint, moderate
p, moderator, review, read
p, moderator, review, moderate
p, moderator, endorsement, read
p, moderator, endorsement, moderate
p, moderator, tag, read
p, moderator, tag, moderate
p, moderator, field_node, read
p, moderator, user, read

# Authority-editor permissions (knowledge graph)
p, graph-editor, field_node, read
p, graph-editor, field_node, create
p, graph-editor, field_node, update
p, graph-editor, field_node, approve
p, graph-editor, authority, read
p, graph-editor, authority, create
p, graph-editor, authority, update
p, graph-editor, authority, approve
p, graph-editor, facet, read
p, graph-editor, facet, create
p, graph-editor, facet, update

# Author permissions
p, author, eprint, read
p, author, eprint, create
p, author, review, read
p, author, review, create
p, author, endorsement, read
p, author, endorsement, create
p, author, tag, read
p, author, tag, create
p, author, field_node, read
p, author, authority, read
p, author, facet, read

# Reader permissions (default for authenticated users)
p, reader, eprint, read
p, reader, review, read
p, reader, endorsement, read
p, reader, tag, read
p, reader, field_node, read
p, reader, authority, read
p, reader, facet, read
p, reader, user, read
