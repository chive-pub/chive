{{- if not .Values.secrets.existingSecret -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "chive.fullname" . }}-secrets
  labels:
    {{- include "chive.labels" . | nindent 4 }}
type: Opaque
stringData:
  {{- if .Values.secrets.postgresPassword }}
  POSTGRES_PASSWORD: {{ .Values.secrets.postgresPassword | quote }}
  {{- else }}
  POSTGRES_PASSWORD: {{ randAlphaNum 32 | quote }}
  {{- end }}
  {{- if .Values.secrets.neo4jAuth }}
  NEO4J_AUTH: {{ .Values.secrets.neo4jAuth | quote }}
  NEO4J_PASSWORD: {{ (split "/" .Values.secrets.neo4jAuth)._1 | default (randAlphaNum 32) | quote }}
  {{- else }}
  NEO4J_AUTH: "neo4j/{{ randAlphaNum 32 }}"
  NEO4J_PASSWORD: {{ randAlphaNum 32 | quote }}
  {{- end }}
  {{- if .Values.secrets.jwtSecret }}
  JWT_SECRET: {{ .Values.secrets.jwtSecret | quote }}
  {{- else }}
  JWT_SECRET: {{ randAlphaNum 64 | quote }}
  {{- end }}
  {{- if .Values.secrets.sessionSecret }}
  SESSION_SECRET: {{ .Values.secrets.sessionSecret | quote }}
  {{- else }}
  SESSION_SECRET: {{ randAlphaNum 64 | quote }}
  {{- end }}
{{- end }}
